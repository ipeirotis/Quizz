SELECT A.obj AS name_en, B.obj AS translation, C.mid AS mid, C.frequency AS frequency
FROM (
  SELECT `prefix` as mid, 
	locale_frequency.frequency as frequency
FROM kgraph.completions.latest
WHERE locale_frequency.locale = "el" 
ORDER BY frequency DESC    
  LIMIT 1000
  ) C
JOIN 
(
    SELECT obj, sub 
    FROM kgraph.freebase.triples.latest 
    WHERE pred = "/type/object/name" 
          AND text_lang="el" 
          AND sub IN (SELECT mid FROM(SELECT `prefix` as mid, locale_frequency.frequency AS frequency FROM kgraph.completions.latest, 
WHERE locale_frequency.locale = "el" 
ORDER BY frequency DESC    
LIMIT 1000) ) 
    SHUFFLE BY hash(sub,1000)
) B 
ON C.mid=B.sub
JOIN 
(
    SELECT obj, sub 
    FROM kgraph.freebase.triples.latest 
    WHERE pred = "/type/object/name" 
          AND text_lang="en" 
          AND sub IN (SELECT mid FROM(SELECT `prefix` as mid, locale_frequency.frequency AS frequency FROM kgraph.completions.latest, 
WHERE locale_frequency.locale = "el" 
ORDER BY frequency DESC    
LIMIT 1000) ) 
    SHUFFLE BY hash(sub,1000)
) A
ON A.sub=B.sub
ORDER BY frequency DESC
 

 
